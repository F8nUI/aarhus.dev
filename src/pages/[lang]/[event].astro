---
import Layout from '@layouts/Layout.astro'
import type { GetStaticPaths } from 'astro'
import { getEntry } from 'astro:content'
import { render } from 'astro:content'
import { getCollection } from 'astro:content'

export async function getStaticPaths() {
  const events = await getCollection('events')
  const paths = events.map((event) => {
    const [lang, eventId] = event.id.split('/')
    return {
      params: { lang, event: eventId },
      props: { language: lang, event },
    }
  })

  return paths
}

const { event, language } = Astro.props
const { Content } = await render(event)
const { title, subtitle, venue, organizer: organizerRef } = event.data

const organizer = await getEntry(organizerRef)
const { name: organizerName, website: organizerWebsite } = organizer.data
---

<Layout {language}>
  <h1>{title}</h1>
  {subtitle && <span>{subtitle}</span>}
  <div class="mt-2">
    <Content />
  </div>
</Layout>
